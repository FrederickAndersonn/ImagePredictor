{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stock Prices Dashboard</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/chart.js">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
            color: #333;
        }
        header {
            background-color: #2c3e50;
            color: white;
            padding: 1em;
            text-align: center;
        }
        nav {
            background-color: #34495e;
            overflow: hidden;
        }
        nav a {
            float: left;
            display: block;
            color: #ecf0f1;
            text-align: center;
            padding: 1em 1.5em;
            text-decoration: none;
            transition: background-color 0.3s;
        }
        nav a:hover {
            background-color: #2c3e50;
            color: #ecf0f1;
        }
        main {
            padding: 2em;
            text-align: center;
        }
        button {
            margin: 10px;
            padding: 10px;
            font-size: 16px;
            background-color: #3498db;
            color: white;
            border: none;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #2980b9;
        }
        canvas {
            margin-top: 20px;
        }
        .description {
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        p {
            color: #333;
            line-height: 1.6;
        }
        .logo {
            max-width: 150px;
            margin-top: 20px;
        }
    </style>
</head>
<body>

<header>
    <h1>Stock Prices Dashboard</h1>
</header>

<nav>
    <a href="{% url 'index' %}">Home</a>
</nav>

<main>
    <img class="logo" src="https://cdn.freebiesupply.com/images/large/2x/apple-logo-transparent.png" alt="Apple Logo">
    <h2 id="stockTitle">Apple</h2>
    <div class="description">
        <p>
            Apple Inc. (AAPL) is a global leader in technology, known for its iPhones, iPads, Mac computers, and proprietary operating systems like iOS and macOS.
            Its product design, brand loyalty, and ecosystem integration set it apart. As a financial heavyweight, Apple is among the most valuable companies,
            a key player in the Dow Jones and S&P 500, and a staple for investors. Its market performance is often viewed as a tech sector and economic indicator,
            with its activities closely watched for future growth and innovation potential.
        </p>
    </div>
    {{ img_tag|safe }}
    <canvas id="stockChart" width="600" height="400"></canvas>
    <button class="button" onclick="navigateToGoogle()">Load Apple Stock (Yahoo Finance)</button>
</main>

<script>
    function navigateToGoogle() {
        window.open('https://finance.yahoo.com/quote/AAPL/', '_blank');
    }

    const days = ['Day 1', 'Day 2', 'Day 3', 'Day 4', 'Day 5', 'Day 6', 'Day 7'];

    function loadStockData(jsonFile, stockName) {
        fetch(jsonFile)
            .then(response => response.json())
            .then(data => {
                const stockData = (stockName === 'Apple') ? data.predictions : reverseArray(data.predictions);
                updateChart(stockData, stockName);
            })
            .catch(error => console.error('Error loading stock data:', error));
    }

    function updateChart(data, stockName) {
        const ctx = document.getElementById('stockChart').getContext('2d');
        const myChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: days,
                datasets: [{
                    label: `${stockName} Stock Prices`,
                    data: data,
                    borderColor: 'rgba(75, 192, 192, 1)',
                    borderWidth: 2,
                    fill: false
                }]
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: false
                    }
                }
            }
        });

        document.getElementById('stockTitle').innerText = `${stockName} Stock`;
    }

    window.onload = function () {
        loadStockData('{% static "djangoProject/predictionsAMZN.json" %}', 'Apple');
    };

    function reverseArray(arr) {
        return arr.slice().reverse();
    }
</script>

</body>
</html>
